<!doctype html>
<html class="docs-version-Windows SDK 3.1.7" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.13">
<link rel="alternate" type="application/rss+xml" href="/doc/blog/rss.xml" title="Handpoint RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/doc/blog/atom.xml" title="Handpoint Atom Feed"><title data-react-helmet="true">Integration Guide | Handpoint</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://www.handpoint.com/doc/windows/windowsintegrationguide"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="Windows SDK 3.1.7"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-windows-Windows SDK 3.1.7"><meta data-react-helmet="true" property="og:title" content="Integration Guide | Handpoint"><meta data-react-helmet="true" name="description" content="Hilite &amp; Hi5 - Bluetooth Integration"><meta data-react-helmet="true" property="og:description" content="Hilite &amp; Hi5 - Bluetooth Integration"><link data-react-helmet="true" rel="icon" href="/doc/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://www.handpoint.com/doc/windows/windowsintegrationguide"><link data-react-helmet="true" rel="alternate" href="https://www.handpoint.com/doc/windows/windowsintegrationguide" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://www.handpoint.com/doc/windows/windowsintegrationguide" hreflang="x-default"><link rel="stylesheet" href="/doc/assets/css/styles.fc1f46f8.css">
<link rel="preload" href="/doc/assets/js/runtime~main.7507c79a.js" as="script">
<link rel="preload" href="/doc/assets/js/main.4245f262.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/doc/"><div class="navbar__logo"><img src="/doc/img/handpoint-logo-hvitt.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ" width="90"><img src="/doc/img/handpoint-logo-hvitt.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m" width="90"></div></a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" href="/doc/android/androidintroduction">Android SDK 6.5.0</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/doc/android/androidintroduction">Android SDK 6.5.0</a></li><li><a class="dropdown__link" href="/doc/android/Android SDK 6.4.1/androidintroduction">Android SDK 6.4.1</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" href="/doc/ios/iosintroduction">iOS SDK 4.0.1</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/doc/ios/iosintroduction">iOS SDK 4.0.1</a></li><li><a class="dropdown__link" href="/doc/ios/iOS SDK 4.0.0/iosintroduction">iOS SDK 4.0.0</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" href="/doc/windows/windowsintroduction">Windows SDK 3.1.7</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/doc/windows/windowsintegrationguide">Windows SDK 3.1.7</a></li><li><a class="dropdown__link" href="/doc/windows/Windows SDK 3.1.4/windowsintegrationguide">Windows SDK 3.1.4</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" href="/doc/javascript/javascriptintroduction">JavaScript SDK 6.0.1</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/doc/javascript/javascriptintroduction">JavaScript SDK 6.0.1</a></li><li><a class="dropdown__link" href="/doc/javascript/JavaScript SDK 6.0.0/javascriptintroduction">JavaScript SDK 6.0.0</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" href="/doc/restapi/restintroduction">REST API 2.4.0</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/doc/restapi/restintroduction">REST API 2.4.0</a></li><li><a class="dropdown__link" href="/doc/restapi/REST API 2.3.0/restintroduction">REST API 2.3.0</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" href="/doc/express/expressintroduction">Express SDK 1.3</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/doc/express/expressintroduction">Express SDK 1.3</a></li><li><a class="dropdown__link" href="/doc/express/Express SDK 1.2/expressintroduction">Express SDK 1.2</a></li></ul></div><a href="https://www.npmjs.com/package/cordova-plugin-handpoint" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Cordova Plugin<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/thescruba/xamarin-handpoint-bindings" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Xamarin SDK<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://www.handpoint.com/docs/txnfeedapi/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>TXN Feed API<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://handpoint.atlassian.net/wiki/spaces/PD/overview?homepageId=5898250" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>FAQ<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div><div class="navbar__items navbar__items--right"><a href="https://status.handpoint.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-statuspage-icon" aria-label="Status Page"></a><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE">🌜</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE">🌞</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/windows/windowsintroduction">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/windows/windowsreleasenotes">Release Notes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/windows/windowsapioverview">API overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/doc/windows/windowsintegrationguide">Integration Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/windows/windowstransactions">Transactions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/windows/windowsdevicemanagement">Device management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/windows/windowseventssubscribers">Events subscribers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/windows/windowsevents">Events</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/windows/windowobjects">Objects</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_1CGd"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_3E-R"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><span class="theme-doc-version-badge badge badge--secondary">Version: <!-- -->Windows SDK 3.1.7</span><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Integration Guide</h1></header><h2 class="anchor anchorWithStickyNavbar_31ik" id="hilite--hi5---bluetooth-integration">Hilite &amp; Hi5 - Bluetooth Integration<a aria-hidden="true" class="hash-link" href="#hilite--hi5---bluetooth-integration" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_31ik" id="introduction">Introduction<a aria-hidden="true" class="hash-link" href="#introduction" title="Direct link to heading">​</a></h3><p>This tutorial is guiding you through all the steps to create a basic payment application for Windows devices integrated with a Datecs terminal.</p><p>The new generation of Handpoint SDK&#x27;s is designed to make your life easier. Simple and created for humans, it does not require any specific knowledge of the payment industry to be able to start accepting credit/debit card transactions.</p><p>At Handpoint we take care of securing every transaction so you don´t have to worry about it while creating your application. We encrypt data from the payment terminal to the bank with our point-to-point encryption solution. Our platform is always up to the latest PCI-DSS security requirements.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="lets-start-programming">Let&#x27;s start programming!<a aria-hidden="true" class="hash-link" href="#lets-start-programming" title="Direct link to heading">​</a></h3><p><strong>1. Create a C# class</strong>
Create a new C# class called MyClass and include com.handpoint.api as a dependency :</p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Collections.Generic;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Numerics;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using com.handpoint.api;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">namespace GettingStartedApp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    class MyClass</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>2. Initialize the API</strong></p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Collections.Generic;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Numerics;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using com.handpoint.api;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">namespace GettingStartedApp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    class MyClass</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Hapi api;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public MyClass()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            InitApi();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void InitApi()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            string sharedSecret = &quot;0102030405060708091011121314151617181920212223242526272829303132&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            api = HapiFactory.GetAsyncInterface(this, new HandpointCredentials(sharedSecret));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // The api is now initialized. Yay! we&#x27;ve even set a default shared secret!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // The shared secret is a unique string shared between the card reader and your mobile application.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // It prevents other people to connect to your card reader.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // You should replace this default shared secret by the one sent by our support team.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>3. Implement the mandatory Events(Events.Required) and per recommendation Status events (Events.Status)</strong></p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Collections.Generic;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Numerics;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using com.handpoint.api;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">namespace GettingStartedApp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    class MyClass : Events.Required, Events.Status</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Hapi api;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Device myDevice;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public MyClass()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            InitApi();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void InitApi()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            string sharedSecret = &quot;0102030405060708091011121314151617181920212223242526272829303132&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            api = HapiFactory.GetAsyncInterface(this, new HandpointCredentials(sharedSecret));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void **[*deviceDiscoveryFinished*](#13)**(List&lt;Device&gt; devices)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // Here you get a list of Bluetooth payment terminals paired with your computer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void EndOfTransaction(TransactionResult transactionResult, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          // The TransactionResult object holds details about the transaction as well as the receipts.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          // Useful information can be accessed through this object like the transaction ID, the amount, etc.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void **[*ConnectionStatusChanged*](#7)**(ConnectionStatus status, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // The ConnectionStatus object holds details about the status regarding the connection to the target device.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void CurrentTransactionStatus(StatusInfo info, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // The StatusInfo object holds details about the status and step taken during the transaction.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void SignatureRequired(SignatureRequest signatureRequest, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // You&#x27;ll be notified here if a sale process needs a signature verification</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // A signature verification is needed if the cardholder uses an MSR or a chip &amp; signature card</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // This method will not be invoked if a transaction is made with a Chip &amp; PIN card</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            api.SignatureResult(true); // This line means that the cardholder ALWAYS accepts to sign the receipt.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // A specific line will be displayed on the merchant receipt for the cardholder to be able to sign it</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void HardwareStatusChanged(HardwareStatus status, ConnectionMethod hardware)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // Ignore, legacy event, will be deleted in future version.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>4. Add a method to discover surrounding devices and connect to the card reader</strong>
Ensure that the card reader and PC are correctly paired via bluetooth.</p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">public void DiscoverDevices()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    api.ListDevices(ConnectionMethod.BLUETOOTH);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // This triggers the search for all the bluetooth devices around.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // You can also search for USB and Serial as a connection method</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public void **[*deviceDiscoveryFinished*](#13)**(List&lt;Device&gt; devices)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    foreach (Device device in devices)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        if (device.Name != null)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            if (device.Name.Equals(&quot;PP0513901435&quot;))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // Put the name of your device, find it by doing C then up arrow on your card reader keypad</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                this.device = device;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                //We&#x27;ll remember the device for this session, it is nice if you would do that too</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                api.Connect(this.device);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                //Connection to the device is handled automatically in the API</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>5. Add a method to connect directly to the card reader</strong>
Instead of discovering the surrounding devices you can also directly connect to the card reader by implementing the following method:</p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">public void DirectConnect()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Device device = new Device(&quot;PP0513901435&quot;, &quot;68:AA:D2:00:D5:27&quot;, &quot;&quot;, ConnectionMethod.BLUETOOTH);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    //new Device(&quot;name&quot;, &quot;address&quot;, &quot;port&quot;, ConnectionMethod);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    //The address always has to be written in UPPER CASE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    api.Connect(device);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>6. Add a method to take payments</strong></p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">public bool Pay()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    return api.Sale(new BigInteger(1000), Currency.GBP);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // Let´s start our first payment of 10 pounds</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>7. Add a method to disconnect from the card reader</strong></p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">public void Disconnect()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    api.Disconnect();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>8. Eventually, MyClass.cs must look like this after implementing all the necessary methods :</strong></p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Collections.Generic;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Numerics;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using com.handpoint.api;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">namespace GettingStartedApp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    class MyClass : Events.Required, Events.Status</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Hapi api;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Device myDevice;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public MyClass(Form1 form1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            InitApi();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void InitApi()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            string sharedSecret = &quot;0102030405060708091011121314151617181920212223242526272829303132&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            api = HapiFactory.GetAsyncInterface(this, new HandpointCredentials(sharedSecret));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void DiscoverDevices()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            api.SearchDevices(ConnectionMethod.BLUETOOTH);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void **[*deviceDiscoveryFinished*](#13)**(List&lt;Device&gt; devices)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            foreach (Device device in devices)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                if (device.Name != null)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    if (device.Name.Equals(&quot;PP0513901435&quot;))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        this.device = device;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        api.Connect(this.device);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void DirectConnect()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            Device device = new Device(&quot;PP0513901435&quot;, &quot;68:AA:D2:00:D5:27&quot;, &quot;&quot;, ConnectionMethod.BLUETOOTH);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            api.Connect(device);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public bool Pay()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            return api.Sale(new BigInteger(1000), Currency.GPB);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void Disconnect()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            api.Disconnect();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void **[*ConnectionStatusChanged*](#7)**(ConnectionStatus status, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            Console.WriteLine(&quot;*** ConnectionStatus *** &quot; + status);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void CurrentTransactionStatus(StatusInfo info, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            Console.WriteLine(&quot;*** CurrentTransactionStatus *** &quot; + info.Status.ToString());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void SignatureRequired(SignatureRequest signatureRequest, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                api.SignatureResult(true);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void EndOfTransaction(TransactionResult result, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            Console.WriteLine(&quot;*** EndOfTransaction *** &quot; + result.ToJSON());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void HardwareStatusChanged(HardwareStatus status, ConnectionMethod hardware)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            //Ignore</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="lets-create-a-user-interface">Let&#x27;s create a User Interface!<a aria-hidden="true" class="hash-link" href="#lets-create-a-user-interface" title="Direct link to heading">​</a></h3><p><strong>1. Create buttons</strong></p><ul><li>Go to your user interface (usually Form1.cs<!-- -->[Design]<!-- -->)</li><li>Select View &gt; Toolbox</li><li>In the toolbox, under “Common Controls” drag and drop 3 button items to the user interface</li><li>Select &quot;button1&quot; &gt; Right-Click &gt; Properties</li><li>Change the attribute &quot;Name&quot; from &quot;button1&quot; to &quot;PayButton&quot;</li><li>Change the attribute &quot;text&quot; from &quot;button1&quot; to &quot;Pay Now&quot;</li><li>Change the attribute &quot;Name&quot; from &quot;button2&quot; to &quot;ConnectButton&quot;</li><li>Change the attribute &quot;text&quot; from &quot;button2&quot; to &quot;Connect To Card reader&quot;</li><li>Change the attribute &quot;Name&quot; from &quot;button3&quot; to &quot;DisconnectButton&quot;</li><li>Change the attribute &quot;text&quot; from &quot;button3&quot; to &quot;Disconnect From Card Reader&quot;</li><li>Select View &gt; Toolbox &gt; Common Controls &gt; Label</li><li>Change the attribute &quot;Name&quot; from &quot;label1&quot; to &quot;ConnectionLabel&quot;</li><li>Change the attribute &quot;text&quot; from &quot;label1&quot; to &quot;Disconnected&quot;</li><li>Change the attribute &quot;backColor&quot; from &quot;label1&quot; to &quot;Red&quot;</li></ul><p><strong>2. Create WebBrowsers</strong></p><p>Now that we have our 3 buttons, let´s create two webBrowsers items to display the merchant receipt as well as the cardholder´s receipt at the end of the transaction.</p><ul><li>Select View &gt; Toolbox &gt; Common Controls &gt; WebBrowser</li><li>Drag and drop two web browsers to the user interface</li><li>Select View &gt; Toolbox &gt; Common Controls &gt; Label</li><li>Drag and drop two labels to the user interface in order to identify the webBrowser items</li><li>Change the attribute &quot;Name&quot; from the left webBrowser to &quot;MerchantReceiptBrowser&quot;</li><li>Change the attribute &quot;Name&quot; from the right webBrowser to &quot;CardholderReceiptBrowser&quot;</li><li>Change the attribute &quot;Name&quot; from &quot;label2&quot; to &quot;MerchantReceiptLabel&quot;</li><li>Change the attribute &quot;text&quot; from &quot;label2&quot; to &quot;Merchant Receipt :&quot;</li><li>Change the attribute &quot;Name&quot; from &quot;label3&quot; to &quot;CardholderReceiptLabel&quot;</li><li>Change the attribute &quot;text&quot; from &quot;label3&quot; to &quot;Cardholder Receipt :&quot;</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="lets-link-our-user-interface-with-methods">Let&#x27;s link our user interface with methods!<a aria-hidden="true" class="hash-link" href="#lets-link-our-user-interface-with-methods" title="Direct link to heading">​</a></h3><p><strong>1. Referencing the user interface(Form1.cs) in MyClass</strong></p><p>In MyClass.cs, create an instance of Form1 called UIClass and initialize it. Instantiate MyClass and add form1 as a parameter for the Class.</p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">class MyClass : Events.Required, Events.Status</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Hapi api;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Device myDevice;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private Form1 uIClass;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public MyClass(Form1 form1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        uIClass = form1;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        InitApi();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    [...]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>2. Referencing Myclass in Form1.cs and link methods to the user interface</strong></p><p>Go to Form1.cs<!-- -->[Design]<!-- --> and double click on the button &quot;Pay Now&quot;. By Double Clicking on it you created a method called PayButton_Click. Create a new instance of MyClass called &quot;my&quot; in Form1.cs then, inside the new method PayButton_Click call the Pay() method from MyClass.</p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Drawing;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Windows.Forms;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">namespace GettingStartedApp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public partial class Form1 : Form</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        MyClass my;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public Form1()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            InitializeComponent();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            my = new MyClass(this);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        private void PayButton_Click(object sender, EventArgs e)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            my.Pay();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Go back to Form1.cs<!-- -->[Design]<!-- --> and double click on each of the other buttons to automatically generate an OnClick method in Form1.cs. Link each of the buttons to the correct methods in MyClass.cs.</p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Drawing;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Windows.Forms;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">namespace GettingStartedApp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public partial class Form1 : Form</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        MyClass my;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public Form1()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            InitializeComponent();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            my = new MyClass(this);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        private void PayButton_Click(object sender, EventArgs e)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            my.Pay();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        private void ConnectButton_Click(object sender, EventArgs e)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            //my.DiscoverDevices();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            my.DirectConnect();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        private void DisconnectButton_Click(object sender, EventArgs e)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            my.Disconnect();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="lets-notify-the-user-when-the-app-is-connected-and-ready-to-send-the-transaction">Let´s notify the user when the app is connected and ready to send the transaction<a aria-hidden="true" class="hash-link" href="#lets-notify-the-user-when-the-app-is-connected-and-ready-to-send-the-transaction" title="Direct link to heading">​</a></h3><p><strong>Update the ConnectionLabel to notify the user of the connection status</strong>
Get the connection status from the method <strong><a href="#7"><em>ConnectionStatusChanged</em></a></strong> in MyClass.cs.</p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">public void **[*ConnectionStatusChanged*](#7)**(ConnectionStatus status, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Console.WriteLine(&quot;*** ConnectionStatus *** &quot; + status);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (status == ConnectionStatus.Connected)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        uIClass.UpdateLabel(true);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    else</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        uIClass.UpdateLabel(false);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public void CurrentTransactionStatus(StatusInfo info, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    //Let also console log the status during the transaction</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Console.WriteLine(&quot;*** CurrentTransactionStatus *** &quot; + info.Status.ToString());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Create the UpdateLabel method in Form1.cs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public delegate void UpdateConnectionLabel(bool Connected);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public void UpdateLabel(bool Connected)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    //Only need to check for one of the webbrowsers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (ConnectionLabel.InvokeRequired)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        UpdateConnectionLabel d = new UpdateConnectionLabel(UpdateLabel);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        this.Invoke(d, new object[] { Connected });</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    else</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        if (Connected)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            ConnectionLabel.Text = &quot;Connected&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            ConnectionLabel.BackColor = Color.Green;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        else {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            ConnectionLabel.Text = &quot;Disconnected&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            ConnectionLabel.BackColor = Color.Red;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="lets-display-the-receipts-at-the-end-of-a-transaction">Let´s display the receipts at the end of a transaction!<a aria-hidden="true" class="hash-link" href="#lets-display-the-receipts-at-the-end-of-a-transaction" title="Direct link to heading">​</a></h3><p><strong>1. Fetch the cardholder&#x27;s and merchant receipts from the method EndOfTransaction in MyClass</strong>
At this point all the buttons are connected but we are still missing to display the receipts in the webBrowsers. First, let´s get the receipts from the method EndOfTransaction in myClass.cs.</p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">public void EndOfTransaction(TransactionResult transactionResult, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Console.WriteLine(&quot;*** EndOfTransaction *** &quot; + result.ToJSON());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    uIClass.DisplayReceipts(result.MerchantReceipt, result.CustomerReceipt);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>2. Create the DisplayReceipts method in form1.cs</strong></p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">public delegate void UpdateReceiptsCallback(string MerchantReceipt, string CustomerReceipt);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public void DisplayReceipts(string MerchantReceipt, string CustomerReceipt)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    //Only need to check for one of the webbrowsers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (MerchantReceiptBrowser.InvokeRequired)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        UpdateReceiptsCallback d = new UpdateReceiptsCallback(DisplayReceipts);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        this.Invoke(d, new object[] { MerchantReceipt, CustomerReceipt });</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    else</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        MerchantReceiptBrowser.DocumentText = MerchantReceipt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        CardholderReceiptBrowser.DocumentText = CustomerReceipt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="final-result">Final Result!<a aria-hidden="true" class="hash-link" href="#final-result" title="Direct link to heading">​</a></h3><p>Here is how MyClass.cs and Form1.cs must eventually look like :</p><p><strong>1. MyClass.cs :</strong></p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Collections.Generic;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Numerics;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using com.handpoint.api;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">namespace GettingStartedApp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    class MyClass : Events.Required, Events.Status</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Hapi api;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Device myDevice;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        private Form1 uIClass;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public MyClass(Form1 form1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            uIClass = form1;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            InitApi();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void InitApi()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            string sharedSecret = &quot;0102030405060708091011121314151617181920212223242526272829303132&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            api = HapiFactory.GetAsyncInterface(this, new HandpointCredentials(sharedSecret));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void DiscoverDevices()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            api.SearchDevices(ConnectionMethod.BLUETOOTH);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void DirectConnect()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            Device device = new Device(&quot;PP0513901435&quot;, &quot;68:AA:D2:00:D5:27&quot;, &quot;&quot;, ConnectionMethod.BLUETOOTH);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">             api.Connect(device);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public bool Pay()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            return api.Sale(new BigInteger(1000), Currency.GBP);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void Disconnect()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            api.Disconnect();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void **[*ConnectionStatusChanged*](#7)**(ConnectionStatus status, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            Console.WriteLine(&quot;*** ConnectionStatus *** &quot; + status);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            if (status == ConnectionStatus.Connected)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                uIClass.UpdateLabel(true);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            else</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                uIClass.UpdateLabel(false);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void CurrentTransactionStatus(StatusInfo info, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            //Let&#x27;s log also the status during the transaction</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            Console.WriteLine(&quot;*** CurrentTransactionStatus *** &quot; + info.Status.ToString());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void **[*deviceDiscoveryFinished*](#13)**(List&lt;Device&gt; devices)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            foreach (Device device in devices)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                if (device.Name != null)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    if (device.Name.Equals(&quot;PP0513901435&quot;))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        this.device = device;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        api.Connect(this.device);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void EndOfTransaction(TransactionResult result, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            Console.WriteLine(&quot;*** EndOfTransaction *** &quot; + result.ToJSON());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            uIClass.DisplayReceipts(result.MerchantReceipt, result.CustomerReceipt);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void SignatureRequired(SignatureRequest signatureRequest, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            api.SignatureResult(true); // This line means that the cardholder ALWAYS accepts to sign the receipt.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void HardwareStatusChanged(HardwareStatus status, ConnectionMethod hardware)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            //Ignore</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>2. Form1.cs :</strong></p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Drawing;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Windows.Forms;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">namespace GettingStartedApp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public partial class Form1 : Form</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        MyClass my;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public Form1()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            InitializeComponent();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            my = new MyClass(this);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        private void PayButton_Click(object sender, EventArgs e)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            my.Pay();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        private void ConnectButton_Click(object sender, EventArgs e)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            my.DirectConnect();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        private void DisconnectButton_Click(object sender, EventArgs e)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            my.Disconnect();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public delegate void UpdateReceiptsCallback(string MerchantReceipt, string CustomerReceipt);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void DisplayReceipts(string MerchantReceipt, string CustomerReceipt)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            //Only need to check for one of the webbrowsers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            if (MerchantReceiptBrowser.InvokeRequired)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                UpdateReceiptsCallback d = new UpdateReceiptsCallback(DisplayReceipts);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                this.Invoke(d, new object[] { MerchantReceipt, CustomerReceipt });</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            else</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                MerchantReceiptBrowser.DocumentText = MerchantReceipt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                CardholderReceiptBrowser.DocumentText = CustomerReceipt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public delegate void UpdateConnectionLabel(bool connected);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void UpdateLabel(bool Connected)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            //Only need to check for one of the webbrowsers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            if (ConnectionLabel.InvokeRequired)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                UpdateConnectionLabel d = new UpdateConnectionLabel(UpdateLabel);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                this.Invoke(d, new object[] { Connected });</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            else</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                if (Connected)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    ConnectionLabel.Text = &quot;Connected&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    ConnectionLabel.BackColor = Color.Green;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                else {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    ConnectionLabel.Text = &quot;Disconnected&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    ConnectionLabel.BackColor = Color.Red;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="lets-run-our-program">Let&#x27;s run our program!<a aria-hidden="true" class="hash-link" href="#lets-run-our-program" title="Direct link to heading">​</a></h3><p>Run the program by clicking the &quot;play&quot; button :</p><ol><li>Click on &quot;Connect To Card Reader&quot;, this can take a little bit of time (10 sec max) due to the fact that we are looking for all the devices around before connecting to a specific one</li><li>Click &quot;Pay Now&quot;</li><li>Follow the instructions on the card reader</li><li>When the transaction is finished, the receipts should be displayed in the webBrowsers</li><li>Click on &quot;Disconnect From Card Reader&quot; to stop the connection with the card reader</li></ol><h2 class="anchor anchorWithStickyNavbar_31ik" id="pax--telpo---cloud-integration">PAX &amp; Telpo - Cloud Integration<a aria-hidden="true" class="hash-link" href="#pax--telpo---cloud-integration" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_31ik" id="introduction-1">Introduction<a aria-hidden="true" class="hash-link" href="#introduction-1" title="Direct link to heading">​</a></h3><h3 class="anchor anchorWithStickyNavbar_31ik" id="lets-start-programming-1">Let&#x27;s start programming!<a aria-hidden="true" class="hash-link" href="#lets-start-programming-1" title="Direct link to heading">​</a></h3><p><strong>1. Create a C# class</strong></p><p>Create a new C# class called MyClass and include com.handpoint.api as a dependency :</p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Collections.Generic;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Numerics;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using com.handpoint.api;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">namespace GettingStartedApp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    class MyClass</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>2. Initialize the API</strong></p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Collections.Generic;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Numerics;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using com.handpoint.api;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">namespace GettingStartedApp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    class MyClass</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Hapi api;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public MyClass()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            InitApi();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void InitApi()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            string sharedSecret = &quot;0102030405060708091011121314151617181920212223242526272829303132&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            string apikey = &quot;This-is-my-api-key-provided-by-Handpoint&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            api = HapiFactory.GetAsyncInterface(this, new HandpointCredentials(sharedSecret, apikey));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // The api is now initialized. Yay! we&#x27;ve even set default credentials.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // The shared secret is a unique string shared between the payment terminal and your application, it is a free field.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // The Api key is a unique key per merchant used to authenticate the terminal against the Cloud.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // You should replace the API key with the one sent by the Handpoint support team.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>3. Implement the mandatory Events(Events.Required) and per recommendation Status events (Events.Status)</strong></p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Collections.Generic;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Numerics;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using com.handpoint.api;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">namespace GettingStartedApp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    class MyClass : Events.Required, Events.Status</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Hapi api;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Device myDevice;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public MyClass()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            InitApi();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void InitApi()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            string sharedSecret = &quot;0102030405060708091011121314151617181920212223242526272829303132&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            string apikey = &quot;This-is-my-api-key-provided-by-Handpoint&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            api = HapiFactory.GetAsyncInterface(this, new HandpointCredentials(sharedSecret, apikey));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void **[*deviceDiscoveryFinished*](#13)**(List&lt;Device&gt; devices)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          // here you get a list of payment terminals associated with the api key.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void EndOfTransaction(TransactionResult transactionResult, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          // The TransactionResult object holds details about the transaction as well as the receipts.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          // Useful information can be accessed through this object like the transaction ID, the amount, etc.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void **[*ConnectionStatusChanged*](#7)**(ConnectionStatus status, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // The ConnectionStatus object holds details about the status regarding the connection to the target device.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void CurrentTransactionStatus(StatusInfo info, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // The StatusInfo object holds details about the status and step taken during the transaction.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void SignatureRequired(SignatureRequest request, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // Ignore for a PAX/Telpo integration. The complete signature capture process</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // is already handled in the sdk, a dialog will prompt the user for a signature if required.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // If a signature was entered, it should be printed on the receipts.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void HardwareStatusChanged(HardwareStatus status, ConnectionMethod hardware)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // Ignore, legacy event, will be deleted in future version.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>4. Add a method to list the terminals of your merchant and connect to one of them</strong>
Ensure that the card reader and PC are correctly paired via Cloud connection.</p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">public void DiscoverDevices()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // This triggers the search for all the cloud devices related to your Api Key.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    api.SearchDevices(ConnectionMethod.CLOUD);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public void **[*deviceDiscoveryFinished*](#13)**(List&lt;Device&gt; devices)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    foreach (Device device in devices)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        if (device.Name != null)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            if (device.Name.Equals(&quot;9822032398-PAXA920&quot;))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // Put the name of your device, it is the composition of: serial number - device model.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            // Example for a PAX A920 device: serial_number - model -&gt; 9822032398-PAXA920</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                this.myDevice = device;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              //We&#x27;ll remember the device for this session, it is nice if you would do that too</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              api.Connect(this.myDevice);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              //Connection to the device is handled automatically by the api</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>5. Add a method to connect directly to the payment terminal</strong>
Instead of discovering terminals you can also connect directly to one of them:</p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">public void DirectConnect()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Device device = new Device(&quot;CloudDevice&quot;, &quot;9822032398-PAXA920&quot;, &quot;&quot;, ConnectionMethod.CLOUD);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // new Device(&quot;name&quot;, &quot;address&quot;, &quot;port (optional)&quot;, ConnectionMethod);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // The address always has to be written in UPPER CASE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // It is the composition of the serial number and model ot the payment terminal.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // Example for a PAX A920 device: serial_number - model  -&gt; 9822032398-PAXA920</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    api.Connect(device);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>6. Add a method to take payments</strong></p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">public bool Pay()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    return api.Sale(new BigInteger(1000), Currency.EUR);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // Let´s start our first transaction for 10 euros</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // The amount should always be in the minor unit of the currency</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>7. Add a method to disconnect from the card reader</strong></p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">public void Disconnect()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    api.Disconnect();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>8. Eventually, MyClass.cs must look like this after implementing all the necessary methods :</strong></p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Collections.Generic;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Numerics;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using com.handpoint.api;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">namespace GettingStartedApp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    class MyClass : Events.Required, Events.Status</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Hapi api;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Device myDevice;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public MyClass(Form1 form1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            InitApi();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void InitApi()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            string sharedSecret = &quot;0102030405060708091011121314151617181920212223242526272829303132&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            string apikey = &quot;This-is-my-api-key-provided-by-Handpoint&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            api = HapiFactory.GetAsyncInterface(this, new HandpointCredentials(sharedSecret, apikey));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void DiscoverDevices()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            api.SearchDevices(ConnectionMethod.CLOUD);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void **[*deviceDiscoveryFinished*](#13)**(List&lt;Device&gt; devices)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            foreach (Device device in devices)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                if (device.Name != null)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    if (device.Name.Equals(&quot;9822032398-PAXA920&quot;))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        this.myDevice = device;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        api.Connect(this.myDevice);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void DirectConnect()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            Device device = new Device(&quot;CloudDevice&quot;, &quot;9822032398-PAXA920&quot;, &quot;&quot;, ConnectionMethod.CLOUD);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            api.Connect(device);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public bool Pay()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            return api.Sale(new BigInteger(1000), Currency.EUR);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void Disconnect()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            api.Disconnect();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void **[*ConnectionStatusChanged*](#7)**(ConnectionStatus status, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            Console.WriteLine(&quot;*** ConnectionStatus *** &quot; + status);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void CurrentTransactionStatus(StatusInfo info, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            Console.WriteLine(&quot;*** CurrentTransactionStatus *** &quot; + info.Status.ToString());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void EndOfTransaction(TransactionResult result, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            Console.WriteLine(&quot;*** EndOfTransaction *** &quot; + result.ToJSON());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void HardwareStatusChanged(HardwareStatus status, ConnectionMethod hardware)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            //Ignore</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void SignatureRequired(SignatureRequest request, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            //Ignore</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="lets-create-a-user-interface-1">Let&#x27;s create a User Interface!<a aria-hidden="true" class="hash-link" href="#lets-create-a-user-interface-1" title="Direct link to heading">​</a></h3><p><strong>1. Create buttons and labels</strong></p><ul><li>Go to your user interface (usually Form1.cs<!-- -->[Design]<!-- -->)</li><li>Select View &gt; Toolbox</li><li>In the toolbox, under “Common Controls” drag and drop 3 button items to the user interface</li><li>Select &quot;button1&quot; &gt; Right-Click &gt; Properties</li><li>Change the attribute &quot;Name&quot; from &quot;button1&quot; to &quot;PayButton&quot;</li><li>Change the attribute &quot;text&quot; from &quot;button1&quot; to &quot;Pay Now&quot;</li><li>Change the attribute &quot;Name&quot; from &quot;button2&quot; to &quot;ConnectButton&quot;</li><li>Change the attribute &quot;text&quot; from &quot;button2&quot; to &quot;Connect To Card reader&quot;</li><li>Change the attribute &quot;Name&quot; from &quot;button3&quot; to &quot;DisconnectButton&quot;</li><li>Change the attribute &quot;text&quot; from &quot;button3&quot; to &quot;Disconnect From Card Reader&quot;</li><li>Select View &gt; Toolbox &gt; Common Controls &gt; Label</li><li>Change the attribute &quot;Name&quot; from &quot;label1&quot; to &quot;ConnectionLabel&quot;</li><li>Change the attribute &quot;text&quot; from &quot;label1&quot; to &quot;Disconnected&quot;</li><li>Change the attribute &quot;backColor&quot; from &quot;label1&quot; to &quot;Red&quot;</li></ul><p><strong>2. Create WebBrowsers</strong>
Now that we have our 3 buttons, let´s create two webBrowsers items to display the merchant receipt as well as the cardholder´s receipt at the end of the transaction.</p><ul><li>Select View &gt; Toolbox &gt; Common Controls &gt; WebBrowser</li><li>Drag and drop two web browsers to the user interface</li><li>Select View &gt; Toolbox &gt; Common Controls &gt; Label</li><li>Drag and drop two labels to the user interface in order to identify the webBrowser items</li><li>Change the attribute &quot;Name&quot; from the left webBrowser to &quot;MerchantReceiptBrowser&quot;</li><li>Change the attribute &quot;Name&quot; from the right webBrowser to &quot;CardholderReceiptBrowser&quot;</li><li>Change the attribute &quot;Name&quot; from &quot;label2&quot; to &quot;MerchantReceiptLabel&quot;</li><li>Change the attribute &quot;text&quot; from &quot;label2&quot; to &quot;Merchant Receipt :&quot;</li><li>Change the attribute &quot;Name&quot; from &quot;label3&quot; to &quot;CardholderReceiptLabel&quot;</li><li>Change the attribute &quot;text&quot; from &quot;label3&quot; to &quot;Cardholder Receipt :&quot;</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="lets-link-our-user-interface-with-methods-1">Let&#x27;s link our user interface with methods!<a aria-hidden="true" class="hash-link" href="#lets-link-our-user-interface-with-methods-1" title="Direct link to heading">​</a></h3><p><strong>1. Referencing the user interface(Form1.cs) in MyClass</strong></p><p>In MyClass.cs, create an instance of Form1 called UIClass and initialize it. Instantiate MyClass and add form1 as a parameter for the Class.</p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">class MyClass : Events.Required, Events.Status</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Hapi api;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Device myDevice;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private Form1 uIClass;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public MyClass(Form1 form1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        uIClass = form1;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        InitApi();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    [...]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>2. Referencing Myclass in Form1.cs and link methods to the user interface</strong>
Go to Form1.cs<!-- -->[Design]<!-- --> and double click on the button &quot;Pay Now&quot;. By Double Clicking on it you created a method called PayButton_Click. Create a new instance of MyClass called &quot;my&quot; in Form1.cs then, inside the new method PayButton_Click call the Pay() method from MyClass.</p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Drawing;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Windows.Forms;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">namespace GettingStartedApp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public partial class Form1 : Form</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        MyClass my;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public Form1()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            InitializeComponent();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            my = new MyClass(this);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        private void PayButton_Click(object sender, EventArgs e)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            my.Pay();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Go back to Form1.cs<!-- -->[Design]<!-- --> and double click on each of the other buttons to automatically generate an OnClick method in Form1.cs. Link each of the buttons to the correct methods in MyClass.cs.</p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Drawing;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Windows.Forms;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">namespace GettingStartedApp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public partial class Form1 : Form</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        MyClass my;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public Form1()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            InitializeComponent();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            my = new MyClass(this);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        private void PayButton_Click(object sender, EventArgs e)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            my.Pay();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        private void ConnectButton_Click(object sender, EventArgs e)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            //my.DiscoverDevices();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            my.DirectConnect();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        private void DisconnectButton_Click(object sender, EventArgs e)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            my.Disconnect();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="lets-notify-the-user-when-the-app-is-connected-and-ready-to-send-the-transaction-1">Let´s notify the user when the app is connected and ready to send the transaction<a aria-hidden="true" class="hash-link" href="#lets-notify-the-user-when-the-app-is-connected-and-ready-to-send-the-transaction-1" title="Direct link to heading">​</a></h3><p><strong>1. Update the ConnectionLabel to notify the user of the connection status</strong>
Get the connection status from the method <strong><a href="#7"><em>ConnectionStatusChanged</em></a></strong> in MyClass.cs.</p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">public void **[*ConnectionStatusChanged*](#7)**(ConnectionStatus status, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Console.WriteLine(&quot;*** ConnectionStatus *** &quot; + status);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (status == ConnectionStatus.Connected)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        uIClass.UpdateLabel(true);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    else</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        uIClass.UpdateLabel(false);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public void CurrentTransactionStatus(StatusInfo info, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    //Let also console log the status during the transaction</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Console.WriteLine(&quot;*** CurrentTransactionStatus *** &quot; + info.Status.ToString());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>2. Create the UpdateLabel method in Form1.cs</strong></p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">public delegate void UpdateConnectionLabel(bool Connected);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public void UpdateLabel(bool Connected)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    //Only need to check for one of the webbrowsers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (ConnectionLabel.InvokeRequired)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        UpdateConnectionLabel d = new UpdateConnectionLabel(UpdateLabel);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        this.Invoke(d, new object[] { Connected });</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    else</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        if (Connected)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            ConnectionLabel.Text = &quot;Connected&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            ConnectionLabel.BackColor = Color.Green;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        else {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            ConnectionLabel.Text = &quot;Disconnected&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            ConnectionLabel.BackColor = Color.Red;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="lets-display-the-receipts-at-the-end-of-a-transaction-1">Let´s display the receipts at the end of a transaction!<a aria-hidden="true" class="hash-link" href="#lets-display-the-receipts-at-the-end-of-a-transaction-1" title="Direct link to heading">​</a></h3><p><strong>1. Fetch the cardholder&#x27;s and merchant receipts from the method EndOfTransaction in MyClass</strong>
At this point all the buttons are connected but we are still missing to display the receipts in the webBrowsers. First, let´s get the receipts from the method EndOfTransaction in myClass.cs.</p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">public void EndOfTransaction(TransactionResult transactionResult, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Console.WriteLine(&quot;*** EndOfTransaction *** &quot; + result.ToJSON());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    uIClass.DisplayReceipts(result.MerchantReceipt, result.CustomerReceipt);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>2. Create the DisplayReceipts method in Form1.cs</strong></p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">public delegate void UpdateReceiptsCallback(string MerchantReceipt, string CustomerReceipt);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public void DisplayReceipts(string MerchantReceipt, string CustomerReceipt)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    //Only need to check for one of the webbrowsers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (MerchantReceiptBrowser.InvokeRequired)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        UpdateReceiptsCallback d = new UpdateReceiptsCallback(DisplayReceipts);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        this.Invoke(d, new object[] { MerchantReceipt, CustomerReceipt });</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    else</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        MerchantReceiptBrowser.DocumentText = MerchantReceipt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        CardholderReceiptBrowser.DocumentText = CustomerReceipt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="final-result-1">Final Result!<a aria-hidden="true" class="hash-link" href="#final-result-1" title="Direct link to heading">​</a></h3><p>Here is how MyClass.cs and Form1.cs must eventually look like:</p><p><strong>1. MyClass.cs :</strong></p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Collections.Generic;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Numerics;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using com.handpoint.api;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">namespace GettingStartedApp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    class MyClass : Events.Required, Events.Status</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Hapi api;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Device myDevice;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        private Form1 uIClass;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public MyClass(Form1 form1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            uIClass = form1;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            InitApi();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void InitApi()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            string sharedSecret = &quot;0102030405060708091011121314151617181920212223242526272829303132&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            string apikey = &quot;This-is-my-api-key-provided-by-Handpoint&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            api = HapiFactory.GetAsyncInterface(this, new HandpointCredentials(sharedSecret, apikey));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void DiscoverDevices()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            api.SearchDevices(ConnectionMethod.CLOUD);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void DirectConnect()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            Device device = new Device(&quot;CloudDevice&quot;, &quot;0821032398-PAXA920&quot;, &quot;&quot;, ConnectionMethod.CLOUD);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            api.Connect(device);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public bool Pay()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            return api.Sale(new BigInteger(1000), Currency.EUR);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void Disconnect()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            api.Disconnect();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void **[*ConnectionStatusChanged*](#7)**(ConnectionStatus status, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            Console.WriteLine(&quot;***ConnectionStatus*** &quot; + status);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            if (status == ConnectionStatus.Connected)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                uIClass.UpdateLabel(true);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            else</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                uIClass.UpdateLabel(false);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void CurrentTransactionStatus(StatusInfo info, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            //Let&#x27;s log also the status during the transaction</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            Console.WriteLine(&quot;*** CurrentTransactionStatus *** &quot; + info.Status.ToString());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void **[*deviceDiscoveryFinished*](#13)**(List&lt;Device&gt; devices)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            foreach (Device device in devices)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                if (device.Name != null)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    if (device.Name.Equals(&quot;0821032398-PAXA920&quot;))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        this.myDevice = device;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        api.Connect(this.myDevice);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void EndOfTransaction(TransactionResult result, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            Console.WriteLine(&quot;*** EndOfTransaction *** &quot; + result.ToJSON());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            uIClass.DisplayReceipts(result.MerchantReceipt, result.CustomerReceipt);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void HardwareStatusChanged(HardwareStatus status, ConnectionMethod hardware)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            //Ignore</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public void SignatureRequired(SignatureRequest request, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            //Ignore</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>2. Form1.cs :</strong></p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Drawing;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Windows.Forms;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    namespace GettingStartedApp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public partial class Form1 : Form</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            MyClass my;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public Form1()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                InitializeComponent();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                my = new MyClass(this);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            private void PayButton_Click(object sender, EventArgs e)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                my.Pay();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            private void ConnectButton_Click(object sender, EventArgs e)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                my.DirectConnect();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            private void DisconnectButton_Click(object sender, EventArgs e)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                my.Disconnect();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public delegate void UpdateReceiptsCallback(string MerchantReceipt, string CustomerReceipt);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public void DisplayReceipts(string MerchantReceipt, string CustomerReceipt)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                //Only need to check for one of the webbrowsers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                if (MerchantReceiptBrowser.InvokeRequired)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    UpdateReceiptsCallback d = new UpdateReceiptsCallback(DisplayReceipts);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    this.Invoke(d, new object[] { MerchantReceipt, CustomerReceipt });</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                else</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    MerchantReceiptBrowser.DocumentText = MerchantReceipt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    CardholderReceiptBrowser.DocumentText = CustomerReceipt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public delegate void UpdateConnectionLabel(bool connected);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public void UpdateLabel(bool Connected)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                //Only need to check for one of the webbrowsers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                if (ConnectionLabel.InvokeRequired)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    UpdateConnectionLabel d = new UpdateConnectionLabel(UpdateLabel);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    this.Invoke(d, new object[] { Connected });</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                else</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    if (Connected)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        ConnectionLabel.Text = &quot;Connected&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        ConnectionLabel.BackColor = Color.Green;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    else {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        ConnectionLabel.Text = &quot;Disconnected&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        ConnectionLabel.BackColor = Color.Red;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="lets-run-our-program-1">Let&#x27;s run our program!<a aria-hidden="true" class="hash-link" href="#lets-run-our-program-1" title="Direct link to heading">​</a></h3><p>Run the program by clicking the &quot;play&quot; button :</p><ol><li>Click on &quot;Connect To Card Reader&quot;, this can take a little bit of time (10 sec max) due to the fact that we are looking for all the devices around before connecting to a specific one</li><li>Click &quot;Pay Now&quot;</li><li>Follow the instructions on the card reader</li><li>When the transaction is finished, the receipts should be displayed in the webBrowsers</li><li>Click on &quot;Disconnect From Card Reader&quot; to stop the connection with the card reader</li></ol><h2 class="anchor anchorWithStickyNavbar_31ik" id="terminal-simulator-integration">Terminal Simulator Integration<a aria-hidden="true" class="hash-link" href="#terminal-simulator-integration" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_31ik" id="introduction-2">Introduction<a aria-hidden="true" class="hash-link" href="#introduction-2" title="Direct link to heading">​</a></h3><p>This tutorial is guiding you through all the steps to create a basic payment application for Windows using a card reader simulator. The simulator only has limited capabilities and we highly recommend that you order a development kit if you want to carry a full integration. The development kit contains a card reader as well as a test card and will allow you to test your integration from end to end.</p><p>The new generation of Handpoint SDK&#x27;s is designed to make your life easier. Simple and created for humans, it does not require any specific knowledge of the payment industry to be able to start accepting credit/debit card transactions.</p><p>At Handpoint we take care of securing every transaction so you don´t have to worry about it while creating your application. We encrypt data from the payment terminal to the bank with our point-to-point encryption solution. Our platform is always up to the latest PCI-DSS security requirements.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="connecting-to-the-simulator">Connecting to the simulator<a aria-hidden="true" class="hash-link" href="#connecting-to-the-simulator" title="Direct link to heading">​</a></h3><p>The SDK offers a method in which you will need to specify the card reader to be used:</p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">hapi.useDevice(new Device(&quot;Name&quot;, &quot;Port&quot;, &quot;Address&quot;, ConnectionMethod.****))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Simply set the ConnectionMethod to Simulator, i.e. ConnectionMethod.Simulator. The SDK does the rest. You don&#x27;t need to search via bluetooth for surrounding card readers when using the simulator.</p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">hapi.useDevice(new Device(&quot;Name&quot;, &quot;Port&quot;, &quot;Address&quot;, ConnectionMethod.Simulator))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="controlling-responses">Controlling responses<a aria-hidden="true" class="hash-link" href="#controlling-responses" title="Direct link to heading">​</a></h3><p>The simulator mimics the card reader as much as possible regarding information flow from the SDK interface to your application. It will return all the transaction statuses, transaction results and receipts.</p><p>Results of a transaction are controlled by the amount sent into the sale function:<br>
The 3rd position from the right sets the desired financial status, 0 = Authorized and 1 = Declined.<br>
The 4th position from the right sets the desired verification method, 0 = Signature and 1 = PIN.</p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">hapi.Sale(X10XX, Currency.GBP); // amount = X 10 XX - where X represents an integer [0;9]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li>X 00 XX = Signature authorized</li><li>X 01 XX = Signature declined</li><li>X 10 XX = Pin authorized</li><li>X 11 XX = Pin declined</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="lets-start-programming-2">Let&#x27;s start programming!<a aria-hidden="true" class="hash-link" href="#lets-start-programming-2" title="Direct link to heading">​</a></h3><p><strong>1. Create a C# class</strong>
Create a new C# class called MyClass and include com.handpoint.api as a dependency :</p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Collections.Generic;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Linq;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Text;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using com.handpoint.api;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    namespace GettingStartedWithSimulator</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        class MyClass</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>2. Initialize the API</strong></p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Collections.Generic;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Linq;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Text;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using com.handpoint.api;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    namespace GettingStartedWithSimulator</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        class MyClass</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            Hapi api;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public MyClass()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                InitApi();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public void InitApi()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                string sharedSecret = &quot;0102030405060708091011121314151617181920212223242526272829303132&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                api = HapiFactory.GetAsyncInterface(this, new HandpointCredentials(sharedSecret));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // The api is now initialized. Yay! we&#x27;ve even set a default shared secret!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // The shared secret is a unique string shared between the card reader and your mobile application.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // It prevents other people to connect to your card reader.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>3. Implement the mandatory Events(Events.Required)</strong></p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Collections.Generic;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Linq;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Text;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using com.handpoint.api;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    namespace GettingStartedWithSimulator</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        class MyClass : Events.Required</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            Hapi api;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public MyClass()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                InitApi();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public void InitApi()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                string sharedSecret = &quot;0102030405060708091011121314151617181920212223242526272829303132&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                api = HapiFactory.GetAsyncInterface(this, new HandpointCredentials(sharedSecret));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // The api is now initialized. Yay! we&#x27;ve even set a default shared secret!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // The shared secret is a unique string shared between the card reader and your mobile application</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // It prevents other people to connect to your card reader</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public void **[*deviceDiscoveryFinished*](#13)**(List&lt;Device&gt; devices)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // Only needed when using a payment terminal</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                //here you get a list of Bluetooth payment terminals paired with your PC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // You can also get a list of serial / USB payment terminals attached to your computer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public void SignatureRequired(SignatureRequest signatureRequest, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // You&#x27;ll be notified here if a sale process needs a signature verification</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // A signature verification is needed if the cardholder uses an MSR or a chip &amp; signature card</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // This method will not be invoked if a transaction is made with a Chip &amp; PIN card</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                api.SignatureResult(true); // This line means that the cardholder ALWAYS accepts to sign the receipt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // A specific line will be displayed on the merchant receipt for the cardholder to be able to sign it</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public void EndOfTransaction(TransactionResult transactionResult, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // The object TransactionResult holds the different receipts</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // Other information can be accessed through this object like the transaction ID, the amount...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>4. Add a method to connect to the simulator</strong></p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public void Connect()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Device device = new Device(&quot;Name&quot;, &quot;Address&quot;, &quot;Port&quot;, ConnectionMethod.SIMULATOR);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        api.UseDevice(device);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>5. Add a method to take payments with the simulator</strong></p><p>The simulator mimics the card reader as much as possible regarding the information flow from the SDK interface to your application. The results of the transaction (declined, authorized) and the type of verification method (PIN, signature) will depend on the amount used.</p><p>You can get different responses from the simulator by setting different values for the amount parameter, e.g. for a Sale function :</p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">    api.Sale(X10XX, Currency.GBP); // amount = X 10 XX - where X represents an integer [0;9]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Amount Values</strong></p><ul><li>X00XX = Signature authorized</li><li>X01XX = Signature declined</li><li>X10XX = PIN authorized</li><li>X11XX = PIN declined</li></ul><p>The 3rd number from right sets desired financial status, Authorized or Declined. Default status is Authorized.<br>
The 4th number from right sets desired verification method, Signature or PIN. Default method is Signature.</p><p>Let´s add 4 methods to MyClass in order to represent the 4 cases above :</p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Collections.Generic;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Linq;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Text;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using com.handpoint.api;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    namespace GettingStartedWithSimulator</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        class MyClass : Events.Required</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            Hapi api;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public MyClass()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                InitApi();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public void InitApi()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                string sharedSecret = &quot;0102030405060708091011121314151617181920212223242526272829303132&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                api = HapiFactory.GetAsyncInterface(this, new HandpointCredentials(sharedSecret));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // The api is now initialized. Yay! we&#x27;ve even set a default shared secret!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // The shared secret is a unique string shared between the card reader and your mobile application.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // It prevents other people to connect to your card reader.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public void **[*deviceDiscoveryFinished*](#13)**(List &lt;Device&gt; devices)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                 // Only needed when using a payment terminal</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                 //Here you get a list of Bluetooth payment terminals paired with your PC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                 // You can also get a list of serial / USB payment terminals attached to your computer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public void Connect()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                Device device = new Device(&quot;Name&quot;, &quot;Address&quot;, &quot;Port&quot;, ConnectionMethod.SIMULATOR);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                api.UseDevice(device);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public bool PayWithSignatureAuthorized()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                return api.Sale(new BigInteger(&quot;10000&quot;), Currency.GBP);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // amount X00XX where X represents an integer [0;9] --&gt; Signature authorized</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public bool PayWithSignatureDeclined()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                return api.Sale(new BigInteger(&quot;10100&quot;), Currency.GBP);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // amount X01XX where X represents an integer [0;9] --&gt; Signature declined</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public bool PayWithPinAuthorized()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                return api.Sale(new BigInteger(&quot;11000&quot;), Currency.GBP);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // amount X10XX where X represents an integer [0;9] --&gt; PIN authorized</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public bool PayWithPinDeclined()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                return api.Sale(new BigInteger(&quot;11100&quot;), Currency.GBP);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // amount X11XX where X represents an integer [0;9] --&gt; PIN declined</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public void SignatureRequired(SignatureRequest signatureRequest, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // You&#x27;ll be notified here if a sale process needs a signature verification</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // A signature verification is needed if the cardholder uses an MSR or a chip &amp; signature card</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // This method will not be invoked if a transaction is made with a Chip &amp; PIN card</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                api.SignatureResult(true); // This line means that the cardholder ALWAYS accepts to sign the receipt.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // A specific line will be displayed on the merchant receipt for the cardholder to be able to sign it</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public void EndOfTransaction(TransactionResult transactionResult, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // The object TransactionResult stores the different receipts</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // Other information can be accessed through this object like the transaction ID, the amount...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="lets-create-a-user-interface-2">Let&#x27;s create a User Interface!<a aria-hidden="true" class="hash-link" href="#lets-create-a-user-interface-2" title="Direct link to heading">​</a></h3><p><strong>1. Create buttons</strong></p><ul><li>Go to your user interface (usually Form1.cs<!-- -->[Design]<!-- -->)</li><li>Select View &gt; Toolbox</li><li>In the toolbox, under “Common Controls” drag and drop 5 button items to the user interface</li><li>Select &quot;button1&quot; &gt; Right-Click &gt; Properties</li><li>Change the attribute &quot;Name&quot; from &quot;button1&quot; to &quot;ConnectToSimulator&quot;</li><li>Change the attribute &quot;text&quot; from &quot;button1&quot; to &quot;Connect To Simulator&quot;</li><li>Change the attribute &quot;Name&quot; from &quot;button2&quot; to &quot;PayWithSignatureAuthorized&quot;</li><li>Change the attribute &quot;text&quot; from &quot;button2&quot; to &quot;Pay With Signature Authorized&quot;</li><li>Change the attribute &quot;Name&quot; from &quot;button3&quot; to &quot;PayWithSignatureDeclined&quot;</li><li>Change the attribute &quot;text&quot; from &quot;button3&quot; to &quot;Pay With Signature Declined&quot;</li><li>Change the attribute &quot;Name&quot; from &quot;button4&quot; to &quot;PayWithPinAuthorized&quot;</li><li>Change the attribute &quot;text&quot; from &quot;button4&quot; to &quot;Pay With Pin Authorized&quot;</li><li>Change the attribute &quot;Name&quot; from &quot;button5&quot; to &quot;PayWithPinDeclined&quot;</li><li>Change the attribute &quot;text&quot; from &quot;button5&quot; to &quot;Pay With Pin Declined&quot;</li></ul><p><strong>2. Create WebBrowsers</strong></p><p>Now that we have our 5 buttons let´s create two webBrowsers items to display the merchant receipt as well as the cardholder´s receipt at the end of the transaction.</p><ul><li>Select View &gt; Toolbox &gt; Common Controls &gt; WebBrowser</li><li>Drag and drop two web browsers to the user interface</li><li>Select View &gt; Toolbox &gt; Common Controls &gt; Label</li><li>Drag and drop two labels to the user interface in order to identify the webBrowser items</li><li>Change the attribute &quot;Name&quot; from the left webBrowser to &quot;MerchantReceiptBrowser&quot;</li><li>Change the attribute &quot;Name&quot; from the right webBrowser to &quot;CardholderReceiptBrowser&quot;</li><li>Change the attribute &quot;Name&quot; from &quot;label1&quot; to &quot;MerchantReceiptLabel&quot;</li><li>Change the attribute &quot;text&quot; from &quot;label1&quot; to &quot;Merchant Receipt :&quot;</li><li>Change the attribute &quot;Name&quot; from &quot;label2&quot; to &quot;CardholderReceiptLabel&quot;</li><li>Change the attribute &quot;text&quot; from &quot;label2&quot; to &quot;Cardholder Receipt :&quot;</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="lets-link-our-user-interface-with-methods-2">Let&#x27;s link our user interface with methods!<a aria-hidden="true" class="hash-link" href="#lets-link-our-user-interface-with-methods-2" title="Direct link to heading">​</a></h3><p><strong>1. Referencing the user interface(Form1.cs) in MyClass</strong></p><p>In MyClass.cs, create an instance of Form1 called UIClass and initialize it. Instantiate MyClass and add form1 as a parameter for the Class.</p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">    class MyClass : Events.Required</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            Hapi api;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            private Form1 UIClass;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public MyClass(Form1 form1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                InitApi();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                UIClass = form1;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>2. Referencing Myclass in Form1.cs and link methods to the user interface</strong></p><p>Go to Form1.cs<!-- -->[Design]<!-- --> and double click on the button &quot;Connect To Simulator&quot;. By Double Clicking on the &quot;Connect To Simulator&quot; button you created a method called ConnectToSimulator_Click. Create a new instance of MyClass called &quot;my&quot; in Form1.cs then, inside the new method ConnectToSimulator_Click call the Connect() method from MyClass.</p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Collections.Generic;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.ComponentModel;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Data;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Drawing;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Linq;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Text;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Windows.Forms;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    namespace GettingStartedWithSimulator</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public partial class Form1 : Form</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            MyClass my;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public Form1()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                InitializeComponent();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                my = new MyClass(this);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            private void ConnectToSimulator_Click(object sender, EventArgs e)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                my.Connect();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Go back to Form1.cs<!-- -->[Design]<!-- --> and double click on each of the other buttons to automatically generate an OnClick method in Form1.cs. Link each of the buttons to the correct methods in MyClass.cs.</p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Collections.Generic;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.ComponentModel;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Data;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Drawing;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Linq;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Text;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Windows.Forms;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    namespace GettingStartedWithSimulator</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public partial class Form1 : Form</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            MyClass my;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public Form1()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                InitializeComponent();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                my = new MyClass(this);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            private void ConnectToSimulator_Click(object sender, EventArgs e)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                my.Connect();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            private void PayWithSignatureAuthorized_Click(object sender, EventArgs e)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                my.PayWithSignatureAuthorized();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            private void PayWithSignatureDeclined_Click(object sender, EventArgs e)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                my.PayWithSignatureDeclined();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            private void PayWithPinAuthorized_Click(object sender, EventArgs e)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                my.PayWithPinAuthorized();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            private void PayWithPinDeclined_Click(object sender, EventArgs e)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                my.PayWithPinDeclined();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="lets-display-the-receipts-at-the-end-of-a-transaction-2">Let´s display the receipts at the end of a transaction!<a aria-hidden="true" class="hash-link" href="#lets-display-the-receipts-at-the-end-of-a-transaction-2" title="Direct link to heading">​</a></h3><p><strong>1. Fetch the cardholder&#x27;s and merchant receipts from the method EndOfTransaction in MyClass</strong></p><p>At this point all the buttons are connected but we are still missing to display the receipts in the webBrowsers. First, let´s get the receipts from the method EndOfTransaction in myClass.cs.</p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public void EndOfTransaction(TransactionResult transactionResult, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                UIClass.DisplayReceipts(transactionResult.MerchantReceipt, transactionResult.CustomerReceipt);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>2. Create the DisplayReceipts method in form1.cs</strong></p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public delegate void UpdateReceiptsCallback(string MerchantReceipt, string CustomerReceipt);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public void DisplayReceipts(string MerchantReceipt, string CustomerReceipt)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                //Only need to check for one of the webBrowsers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                if (MerchantReceiptBrowser.InvokeRequired)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    UpdateReceiptsCallback d = new UpdateReceiptsCallback(DisplayReceipts);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    this.Invoke(d, new object[] { MerchantReceipt, CustomerReceipt });</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                else</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    MerchantReceiptBrowser.DocumentText = MerchantReceipt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    CardholderReceiptBrowser.DocumentText = CustomerReceipt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="final-result-2">Final Result!<a aria-hidden="true" class="hash-link" href="#final-result-2" title="Direct link to heading">​</a></h3><p>Here is how MyClass.cs and Form1.cs must eventually look like :</p><p><strong>1. MyClass.cs :</strong></p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Collections.Generic;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Linq;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Text;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using com.handpoint.api;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    namespace GettingStartedWithSimulator</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        class MyClass : Events.Required</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            Hapi api;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            private Form1 UIClass;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public MyClass(Form1 form1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                InitApi();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                UIClass = form1;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public void InitApi()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                string sharedSecret = &quot;0102030405060708091011121314151617181920212223242526272829303132&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                api = HapiFactory.GetAsyncInterface(this, new HandpointCredentials(sharedSecret));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // The api is now initialized. Yay! we&#x27;ve even set a default shared secret!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // The shared secret is a unique string shared between the card reader and your mobile application.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // It prevents other people to connect to your card reader.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public void **[*deviceDiscoveryFinished*](#13)**(List&lt;Device&gt; devices)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // Only needed when using a payment terminal</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                //Here you get a list of Bluetooth payment terminals paired with your PC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // You can also get a list of serial / USB payment terminals attached to your computer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public void Connect()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                Device device = new Device(&quot;Name&quot;, &quot;Address&quot;, &quot;Port&quot;, ConnectionMethod.SIMULATOR);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                api.UseDevice(device);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public bool PayWithSignatureAuthorized()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                return api.Sale(new BigInteger(&quot;10000&quot;), Currency.GBP);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // amount X00XX where X represents an integer [0;9] --&gt; Signature authorized</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public bool PayWithSignatureDeclined()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                return api.Sale(new BigInteger(&quot;10100&quot;), Currency.GBP);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // amount X01XX where X represents an integer [0;9] --&gt; Signature declined</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public bool PayWithPinAuthorized()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                return api.Sale(new BigInteger(&quot;11000&quot;), Currency.GBP);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // amount X10XX where X represents an integer [0;9] --&gt; PIN authorized</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public bool PayWithPinDeclined()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                return api.Sale(new BigInteger(&quot;11100&quot;), Currency.GBP);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // amount X11XX where X represents an integer [0;9] --&gt; PIN declined</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public void SignatureRequired(SignatureRequest signatureRequest, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // You&#x27;ll be notified here if a sale process needs a signature verification</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // A signature verification is needed if the cardholder uses an MSR or a chip &amp; signature card</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // This method will not be invoked if a transaction is made with a Chip &amp; PIN card</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                api.SignatureResult(true); // This line means that the cardholder ALWAYS accepts to sign the receipt.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                // A specific line will be displayed on the merchant receipt for the cardholder to be able to sign it</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public void EndOfTransaction(TransactionResult transactionResult, Device device)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                UIClass.DisplayReceipts(transactionResult.MerchantReceipt, transactionResult.CustomerReceipt);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>2. Form1.cs :</strong></p><div class="codeBlockContainer_K1bP language-csharp"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Collections.Generic;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.ComponentModel;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Data;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Drawing;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Linq;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Text;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    using System.Windows.Forms;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    namespace GettingStartedWithSimulator</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public partial class Form1 : Form</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            MyClass my;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public Form1()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                InitializeComponent();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                my = new MyClass(this);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            private void ConnectToSimulator_Click(object sender, EventArgs e)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                my.Connect();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            private void PayWithSignatureAuthorized_Click(object sender, EventArgs e)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                my.PayWithSignatureAuthorized();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            private void PayWithSignatureDeclined_Click(object sender, EventArgs e)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                my.PayWithSignatureDeclined();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            private void PayWithPinAuthorized_Click(object sender, EventArgs e)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                my.PayWithPinAuthorized();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            private void PayWithPinDeclined_Click(object sender, EventArgs e)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                my.PayWithPinDeclined();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public delegate void UpdateReceiptsCallback(string MerchantReceipt, string CustomerReceipt);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            public void DisplayReceipts(string MerchantReceipt, string CustomerReceipt)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                //Only need to check for one of the webbrowsers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                if (MerchantReceiptBrowser.InvokeRequired)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    UpdateReceiptsCallback d = new UpdateReceiptsCallback(DisplayReceipts);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    this.Invoke(d, new object[] { MerchantReceipt, CustomerReceipt });</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                else</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    MerchantReceiptBrowser.DocumentText = MerchantReceipt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    CardholderReceiptBrowser.DocumentText = CustomerReceipt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="lets-run-our-program-2">Let&#x27;s run our program!<a aria-hidden="true" class="hash-link" href="#lets-run-our-program-2" title="Direct link to heading">​</a></h3><p>Run the program by clicking the &quot;play&quot; button, click on &quot;Connect to simulator&quot; and then Click on one of the payment types available and have a look at the receipts! Voila!</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/doc/windows/windowsapioverview"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« <!-- -->API overview</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/doc/windows/windowstransactions"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Transactions<!-- --> »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#hilite--hi5---bluetooth-integration" class="table-of-contents__link toc-highlight">Hilite &amp; Hi5 - Bluetooth Integration</a><ul><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#lets-start-programming" class="table-of-contents__link toc-highlight">Let&#39;s start programming!</a></li><li><a href="#lets-create-a-user-interface" class="table-of-contents__link toc-highlight">Let&#39;s create a User Interface!</a></li><li><a href="#lets-link-our-user-interface-with-methods" class="table-of-contents__link toc-highlight">Let&#39;s link our user interface with methods!</a></li><li><a href="#lets-notify-the-user-when-the-app-is-connected-and-ready-to-send-the-transaction" class="table-of-contents__link toc-highlight">Let´s notify the user when the app is connected and ready to send the transaction</a></li><li><a href="#lets-display-the-receipts-at-the-end-of-a-transaction" class="table-of-contents__link toc-highlight">Let´s display the receipts at the end of a transaction!</a></li><li><a href="#final-result" class="table-of-contents__link toc-highlight">Final Result!</a></li><li><a href="#lets-run-our-program" class="table-of-contents__link toc-highlight">Let&#39;s run our program!</a></li></ul></li><li><a href="#pax--telpo---cloud-integration" class="table-of-contents__link toc-highlight">PAX &amp; Telpo - Cloud Integration</a><ul><li><a href="#introduction-1" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#lets-start-programming-1" class="table-of-contents__link toc-highlight">Let&#39;s start programming!</a></li><li><a href="#lets-create-a-user-interface-1" class="table-of-contents__link toc-highlight">Let&#39;s create a User Interface!</a></li><li><a href="#lets-link-our-user-interface-with-methods-1" class="table-of-contents__link toc-highlight">Let&#39;s link our user interface with methods!</a></li><li><a href="#lets-notify-the-user-when-the-app-is-connected-and-ready-to-send-the-transaction-1" class="table-of-contents__link toc-highlight">Let´s notify the user when the app is connected and ready to send the transaction</a></li><li><a href="#lets-display-the-receipts-at-the-end-of-a-transaction-1" class="table-of-contents__link toc-highlight">Let´s display the receipts at the end of a transaction!</a></li><li><a href="#final-result-1" class="table-of-contents__link toc-highlight">Final Result!</a></li><li><a href="#lets-run-our-program-1" class="table-of-contents__link toc-highlight">Let&#39;s run our program!</a></li></ul></li><li><a href="#terminal-simulator-integration" class="table-of-contents__link toc-highlight">Terminal Simulator Integration</a><ul><li><a href="#introduction-2" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#connecting-to-the-simulator" class="table-of-contents__link toc-highlight">Connecting to the simulator</a></li><li><a href="#controlling-responses" class="table-of-contents__link toc-highlight">Controlling responses</a></li><li><a href="#lets-start-programming-2" class="table-of-contents__link toc-highlight">Let&#39;s start programming!</a></li><li><a href="#lets-create-a-user-interface-2" class="table-of-contents__link toc-highlight">Let&#39;s create a User Interface!</a></li><li><a href="#lets-link-our-user-interface-with-methods-2" class="table-of-contents__link toc-highlight">Let&#39;s link our user interface with methods!</a></li><li><a href="#lets-display-the-receipts-at-the-end-of-a-transaction-2" class="table-of-contents__link toc-highlight">Let´s display the receipts at the end of a transaction!</a></li><li><a href="#final-result-2" class="table-of-contents__link toc-highlight">Final Result!</a></li><li><a href="#lets-run-our-program-2" class="table-of-contents__link toc-highlight">Let&#39;s run our program!</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs Legacy</div><ul class="footer__items"><li class="footer__item"><a href="https://www.handpoint.com/docs/device/Basics/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://www.handpoint.com" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Handpoint<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/handpoint" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/handpointltd?lang=en" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Get our Apps</div><ul class="footer__items"><li class="footer__item"><a href="https://play.google.com/store/apps/details?id=com.handpoint.hipos&amp;hl=en&amp;gl=US&amp;pcampaignid=pcampaignidMKT-Other-global-all-co-prtnr-py-PartBadge-Mar2515-1" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Get it on Google Play<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://apps.apple.com/us/app/handpoint/id1450546788?itsct=apps_box_link&amp;itscg=30200" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Download on the App Store<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://status.handpoint.com" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Handpoint Status Page<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://handpoint.atlassian.net/wiki/spaces/PD/overview?homepageId=5898250" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>FAQ<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://handpoint.us6.list-manage.com/subscribe?u=4d9dff9e7edb7e57a67a7b252&amp;id=0a2179241e" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Subscribe to the Handpoint Newsletter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/handpoint" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://www.handpoint.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_MyFc"><img src="https://handpoint.imgix.net/handpoint-logo-w.png?w=150" alt="Handpoint Logo" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="https://handpoint.imgix.net/handpoint-logo-w.png?w=150" alt="Handpoint Logo" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></a></div><div class="footer__copyright">Copyright © 2021 Handpoint</div></div></div></footer></div>
<script src="/doc/assets/js/runtime~main.7507c79a.js"></script>
<script src="/doc/assets/js/main.4245f262.js"></script>
</body>
</html>